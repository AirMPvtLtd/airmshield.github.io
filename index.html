<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AirMShield - AI Cybersecurity & Drone Forensic Tools</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0a0a23 0%, #1c2526 100%);
            color: #b3d4fc;
            font-family: 'Exo 2', sans-serif;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        .hero {
            background: radial-gradient(circle at center, rgba(29, 78, 216, 0.3) 0%, transparent 70%);
            border-bottom: 3px solid #3b82f6;
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: url('https://www.transparenttextures.com/patterns/metal.png');
            opacity: 0.1;
            animation: rotate 60s linear infinite;
        }
        .glow {
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.8), 0 0 30px rgba(59, 130, 246, 0.4);
        }
        .holo-btn {
            background: linear-gradient(45deg, #3b82f6, #60a5fa);
            color: #ffffff;
            border: 1px solid #93c5fd;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            z-index: 10;
        }
        .holo-btn:hover {
            background: linear-gradient(45deg, #60a5fa, #93c5fd);
            box-shadow: 0 0 20px rgba(147, 197, 253, 0.9);
            transform: translateY(-2px);
        }
        .holo-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: 0.5s;
        }
        .holo-btn:hover::after {
            left: 100%;
        }
        .tool-card {
            background: rgba(17, 24, 39, 0.85);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            transition: all 0.3s ease;
            transform: perspective(1000px) rotateX(0deg) rotateY(0deg);
            position: relative;
            z-index: 5;
        }
        .tool-card:hover {
            transform: perspective(1000px) rotateX(2deg) rotateY(-2deg);
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.7);
        }
        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.3) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .tool-card:hover::before {
            opacity: 1;
        }
        .modal {
            background: rgba(17, 24, 39, 0.95);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            max-width: 700px;
            margin: auto;
            top: 50%;
            transform: translateY(-50%);
            box-shadow: 0 0 40px rgba(59, 130, 246, 0.6);
            z-index: 100;
        }
        @keyframes scan {
            0% { transform: translateY(0); opacity: 0.5; }
            50% { transform: translateY(5px); opacity: 1; }
            100% { transform: translateY(0); opacity: 0.5; }
        }
        .scan {
            animation: scan 3s infinite;
        }
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        header, footer {
            background: rgba(10, 10, 35, 0.9);
            border-bottom: 2px solid #3b82f6;
            z-index: 10;
        }
        nav a:hover {
            color: #93c5fd;
            text-shadow: 0 0 15px rgba(147, 197, 253, 0.9);
        }
        input, textarea {
            background: rgba(31, 41, 55, 0.8) !important;
            border: 1px solid #3b82f6 !important;
            transition: all 0.3s ease;
            color: #ffffff !important;
            cursor: text;
            z-index: 10;
            position: relative;
            pointer-events: auto;
            padding: 0.75rem;
            border-radius: 0.5rem;
            width: 100%;
            box-sizing: border-box;
        }
        input:focus, textarea:focus {
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
            border-color: #93c5fd !important;
            outline: none;
        }
        input[type="file"] {
            cursor: pointer;
            padding: 0.5rem;
        }
        .file-label {
            display: inline-block;
            background: rgba(31, 41, 55, 0.8);
            border: 1px solid #3b82f6;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            color: #ffffff;
            z-index: 10;
            transition: all 0.3s ease;
        }
        .file-label:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: #93c5fd;
        }
        .input-loading::after {
            content: 'Processing...';
            color: #60a5fa;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: block;
        }
        input[type="file"] {
            display: none;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="p-4">
        <nav class="flex justify-between items-center max-w-7xl mx-auto">
            <h1 class="text-4xl font-bold text-blue-400">AirMShield</h1>
            <ul class="flex space-x-10 text-xl">
                <li><a href="#" class="hover:text-blue-300 transition">Home</a></li>
                <li><a href="#tools" class="hover:text-blue-300 transition">Security Tools</a></li>
                <li><a href="#" class="hover:text-blue-300 transition">About</a></li>
                <li><a href="#" class="hover:text-blue-300 transition">Contact</a></li>
            </ul>
        </nav>
    </header>

    <section class="hero py-28 text-center relative">
        <h2 class="text-6xl font-bold mb-8 scan">AirMShield Security Matrix</h2>
        <p class="text-2xl mb-10">Initialize a scan to secure your digital airspace.</p>
        <div class="max-w-xl mx-auto">
            <input id="urlInput" type="text" placeholder="https://example.com" class="w-full p-4 rounded-lg text-white mb-6 border glow" onfocus="this.select()">
            <button onclick="checkScore()" class="holo-btn px-10 py-4 rounded-lg text-xl font-semibold">Activate Scan</button>
        </div>
        <div id="result" class="mt-10 text-2xl"></div>
    </section>

    <section id="tools" class="max-w-7xl mx-auto py-20">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
            <!-- Cybersecurity Modules -->
            <div>
                <h2 class="text-5xl font-bold text-center mb-12">Cybersecurity Modules</h2>
                <div class="grid grid-cols-1 gap-8">
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">Phishing Detector</h3>
                        <p class="mb-5">Neutralize phishing threats in URLs/emails.</p>
                        <input id="phishingInput" type="text" placeholder="Enter URL" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('phishing', 'phishingInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="phishingResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">Password Strength Analyzer</h3>
                        <p class="mb-5">Fortify your access credentials.</p>
                        <input id="passwordInput" type="text" placeholder="Enter Password" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('password', 'passwordInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="passwordResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">Threat Predictor</h3>
                        <p class="mb-5">Monitor network anomalies.</p>
                        <input id="threatInput" type="number" placeholder="Enter Log Count" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('threat', 'threatInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="threatResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">SSL Checker</h3>
                        <p class="mb-5">Validate encryption protocols.</p>
                        <input id="sslInput" type="text" placeholder="Enter URL" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('ssl', 'sslInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="sslResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">Malware URL Scanner</h3>
                        <p class="mb-5">Eliminate malicious URLs.</p>
                        <input id="malwareInput" type="text" placeholder="Enter URL" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('malware', 'malwareInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="malwareResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">Brute Force Detector</h3>
                        <p class="mb-5">Counter unauthorized access attempts.</p>
                        <input id="bruteInput" type="number" placeholder="Enter Attempts" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('brute', 'bruteInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="bruteResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">Email Spam Filter</h3>
                        <p class="mb-5">Classify email integrity.</p>
                        <input id="spamInput" type="text" placeholder="Enter Email Text" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('spam', 'spamInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="spamResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">Vulnerability Quick Scan</h3>
                        <p class="mb-5">Assess security headers.</p>
                        <input id="vulnInput" type="text" placeholder="Enter URL" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('vuln', 'vulnInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="vulnResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">DDoS Alert</h3>
                        <p class="mb-5">Detect network overloads.</p>
                        <input id="ddosInput" type="number" placeholder="Enter Traffic" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('ddos', 'ddosInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="ddosResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">User Behavior Monitor</h3>
                        <p class="mb-5">Track anomalous activities.</p>
                        <input id="behaviorInput" type="number" placeholder="Enter Actions" class="w-full mb-4" onfocus="this.select()">
                        <button onclick="runTool('behavior', 'behaviorInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="behaviorResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">Chat Behavior Analyzer</h3>
                        <p class="mb-5">Screen chat for threats.</p>
                        <textarea id="chatInput" placeholder="Enter Chat Messages (one per line)" class="w-full mb-4 h-32" onfocus="this.select()"></textarea>
                        <button onclick="runTool('chat', 'chatInput')" class="holo-btn px-8 py-3 rounded">Engage</button>
                        <div id="chatResult" class="mt-4"></div>
                    </div>
                </div>
            </div>

            <!-- Drone Forensic Matrix -->
            <div>
                <h2 class="text-5xl font-bold text-center mb-12">Drone Forensic Matrix</h2>
                <div class="grid grid-cols-1 gap-8">
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">DroneTraceAI</h3>
                        <p class="mb-5">Decode flight logs for behavioral anomalies.</p>
                        <label for="droneTraceInput" class="file-label">Choose File</label>
                        <input id="droneTraceInput" type="file" accept=".csv,.json,.txt" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('droneTrace', 'droneTraceInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('droneTrace')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="droneTraceResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">SkySniffer</h3>
                        <p class="mb-5">Intercept drone communication signals.</p>
                        <label for="skySnifferInput" class="file-label">Choose File</label>
                        <input id="skySnifferInput" type="file" accept=".pcap,.txt" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('skySniffer', 'skySnifferInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('skySniffer')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="skySnifferResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">DroneGhost</h3>
                        <p class="mb-5">Retrieve erased drone memory data.</p>
                        <label for="droneGhostInput" class="file-label">Choose File</label>
                        <input id="droneGhostInput" type="file" accept=".bin,.dump" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('droneGhost', 'droneGhostInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('droneGhost')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="droneGhostResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">CloudSentry</h3>
                        <p class="mb-5">Extract cloud-synced drone intelligence.</p>
                        <label for="cloudSentryInput" class="file-label">Choose File</label>
                        <input id="cloudSentryInput" type="file" accept=".json,.xml" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('cloudSentry', 'cloudSentryInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('cloudSentry')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="cloudSentryResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">DroneIDLock</h3>
                        <p class="mb-5">Verify drone identity signatures.</p>
                        <label for="droneIDLockInput" class="file-label">Choose File</label>
                        <input id="droneIDLockInput" type="file" accept=".txt,.csv" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('droneIDLock', 'droneIDLockInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('droneIDLock')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="droneIDLockResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">VisionSentryAI</h3>
                        <p class="mb-5">Analyze drone footage for suspicious objects.</p>
                        <label for="visionSentryInput" class="file-label">Choose File</label>
                        <input id="visionSentryInput" type="file" accept=".mp4,.mov,.avi" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('visionSentry', 'visionSentryInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('visionSentry')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="visionSentryResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">FlightPathAI</h3>
                        <p class="mb-5">Detect tampering in telemetry data.</p>
                        <label for="flightPathInput" class="file-label">Choose File</label>
                        <input id="flightPathInput" type="file" accept=".csv,.json" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('flightPath', 'flightPathInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('flightPath')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="flightPathResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">PayloadGuardAI</h3>
                        <p class="mb-5">Verify drone payload integrity.</p>
                        <label for="payloadGuardInput" class="file-label">Choose File</label>
                        <input id="payloadGuardInput" type="file" accept=".csv,.txt" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('payloadGuard', 'payloadGuardInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('payloadGuard')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="payloadGuardResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">SignalTraceAI</h3>
                        <p class="mb-5">Track drone signal origins.</p>
                        <label for="signalTraceInput" class="file-label">Choose File</label>
                        <input id="signalTraceInput" type="file" accept=".pcap,.txt" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('signalTrace', 'signalTraceInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('signalTrace')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="signalTraceResult" class="mt-4"></div>
                    </div>
                    <div class="tool-card p-8">
                        <h3 class="text-3xl font-semibold mb-4">GeoFenceAI</h3>
                        <p class="mb-5">Detect restricted zone breaches.</p>
                        <label for="geoFenceInput" class="file-label">Choose File</label>
                        <input id="geoFenceInput" type="file" accept=".csv,.json" class="w-full mb-4">
                        <div class="flex space-x-6">
                            <button onclick="runDroneTool('geoFence', 'geoFenceInput')" class="holo-btn px-8 py-3 rounded">Analyze</button>
                            <button onclick="showLearnMore('geoFence')" class="bg-gray-700 text-white px-8 py-3 rounded hover:bg-gray-600 border border-blue-500">Protocol</button>
                        </div>
                        <div id="geoFenceResult" class="mt-4"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="p-8 text-center">
        <p>© 2025 AirMShield. All Systems Secured.</p>
    </footer>

    <div id="modal" class="hidden fixed inset-0 flex items-center justify-center z-50">
        <div class="modal p-10">
            <h2 id="modalTitle" class="text-3xl font-bold mb-6"></h2>
            <p id="modalContent" class="mb-8 text-lg"></p>
            <button onclick="closeModal()" class="holo-btn px-8 py-3 rounded">Deactivate</button>
        </div>
    </div>

    <script>
        let pyodide;
        async function loadPyodideAndScripts() {
            pyodide = await loadPyodide();
            await pyodide.runPythonAsync(`
                def check_phishing(url):
                    suspicious_keywords = ["login", "bank", "secure", "update"]
                    score = 0
                    if not url.startswith("https://"):
                        score += 40
                    for keyword in suspicious_keywords:
                        if keyword in url.lower():
                            score += 15
                    return "Phishing" if score > 50 else "Safe", score

                def check_password(password):
                    score = 0
                    if len(password) > 8: score += 30
                    if any(c.isupper() for c in password): score += 20
                    if any(c.isdigit() for c in password): score += 20
                    if any(c in "!@#$%" for c in password): score += 30
                    return "Strong" if score > 70 else "Weak", score

                def predict_threat(log_count):
                    threshold = 100
                    return "Threat" if log_count > threshold else "Normal", log_count

                def check_ssl(url):
                    if url.startswith("https://"):
                        return "Secure", 100
                    return "Insecure", 0

                def scan_malware(url):
                    bad_domains = ["malware.com", "virus.net"]
                    domain = url.split('/')[2] if '/' in url else url
                    return "Malware" if domain in bad_domains else "Clean", 50 if domain in bad_domains else 0

                def detect_brute_force(attempts):
                    threshold = 5
                    return "Brute Force" if attempts > threshold else "Normal", attempts * 10

                def filter_spam(email):
                    spam_words = ["win", "free", "click"]
                    score = 0
                    for word in spam_words:
                        if word in email.lower():
                            score += 30
                    return "Spam" if score > 50 else "Legit", score

                def scan_vuln(url):
                    if url.startswith("https://"):
                        return "Low Risk", 20
                    return "High Risk", 80

                def alert_ddos(traffic):
                    threshold = 1000
                    return "DDoS" if traffic > threshold else "Normal", traffic // 10

                def monitor_behavior(actions):
                    threshold = 50
                    return "Suspicious" if actions > threshold else "Normal", actions * 2

                def analyze_chat(chat):
                    lines = chat.split('\\n')
                    if not lines or all(line.strip() == '' for line in lines):
                        return "Empty", 0
                    score = 0
                    suspicious_words = ["urgent", "click", "free", "win", "password", "login", "bank"]
                    aggressive_words = ["now", "immediately", "hurry", "do it"]
                    total_lines = len([line for line in lines if line.strip()])
                    suspicious_count = 0
                    aggressive_count = 0
                    total_words = 0
                    unique_words = set()
                    for line in lines:
                        if not line.strip():
                            continue
                        words = line.lower().split()
                        total_words += len(words)
                        unique_words.update(words)
                        suspicious_count += sum(1 for word in suspicious_words if word in line.lower())
                        aggressive_count += sum(1 for word in aggressive_words if word in line.lower())
                    if total_lines <= 5:
                        score += 20
                    else:
                        score += 5
                    if suspicious_count == 0:
                        score += 30
                    else:
                        score -= suspicious_count * 5
                    if aggressive_count == 0:
                        score += 20
                    else:
                        score -= aggressive_count * 5
                    if total_words > 10:
                        word_diversity = len(unique_words) / total_words
                        if word_diversity < 0.5:
                            score -= 20
                        else:
                            score += 20
                    avg_line_length = sum(len(line) for line in lines if line.strip()) / total_lines
                    if avg_line_length < 50:
                        score += 10
                    score = max(0, min(100, score))
                    return "Normal" if score > 50 else "Suspicious", score

                def drone_trace_ai(file_content):
                    if file_content:
                        return "Analyzed: Suspicious patterns detected" if "error" in file_content.lower() else "Analyzed: Normal behavior", 75
                    return "No File", 0

                def sky_sniffer(file_content):
                    if file_content:
                        return "Signals Detected: Packet anomalies found" if "packet" in file_content.lower() else "Signals Detected: Normal", 60
                    return "No File", 0

                def drone_ghost(file_content):
                    if file_content:
                        return "Data Recovered: Partial files restored" if "cache" in file_content.lower() else "Data Recovered: No deleted files", 80
                    return "No File", 0

                def cloud_sentry(file_content):
                    if file_content:
                        return "Cloud Data Extracted: Metadata retrieved" if "api" in file_content.lower() else "Cloud Data Extracted: No sync data", 70
                    return "No File", 0

                def drone_id_lock(file_content):
                    if file_content:
                        return "ID Verified: Matches database" if "serial" in file_content.lower() else "ID Verified: No match", 85
                    return "No File", 0

                def vision_sentry_ai(file_content):
                    if file_content:
                        return "Objects Detected: Suspicious activity flagged" if "unknown" in file_content.lower() else "Objects Detected: Normal", 70
                    return "No File", 0

                def flight_path_ai(file_content):
                    if file_content:
                        return "Path Analyzed: Tampering detected" if "deviation" in file_content.lower() else "Path Analyzed: Normal", 80
                    return "No File", 0

                def payload_guard_ai(file_content):
                    if file_content:
                        return "Payload Verified: Anomalies found" if "weight" in file_content.lower() else "Payload Verified: Normal", 75
                    return "No File", 0

                def signal_trace_ai(file_content):
                    if file_content:
                        return "Signal Traced: Origin identified" if "source" in file_content.lower() else "Signal Traced: No origin", 65
                    return "No File", 0

                def geo_fence_ai(file_content):
                    if file_content:
                        return "Zone Analyzed: Breach detected" if "restricted" in file_content.lower() else "Zone Analyzed: Normal", 85
                    return "No File", 0
            `);
        }

        loadPyodideAndScripts();

        async function runTool(tool, inputId) {
            console.log(`Attempting to run tool: ${tool} with input ID: ${inputId}`);
            if (!pyodide) {
                alert("System initializing, please wait...");
                return;
            }
            const inputElement = document.getElementById(inputId);
            inputElement.classList.add('input-loading');
            const input = inputElement.value;
            if (!input) {
                document.getElementById(`${tool}Result`).innerHTML = "Input required for analysis!";
                inputElement.classList.remove('input-loading');
                return;
            }

            let result, score;
            try {
                switch (tool) {
                    case 'phishing': [result, score] = await pyodide.runPythonAsync(`check_phishing("${input}")`); break;
                    case 'password': [result, score] = await pyodide.runPythonAsync(`check_password("${input}")`); break;
                    case 'threat': [result, score] = await pyodide.runPythonAsync(`predict_threat(${input})`); break;
                    case 'ssl': [result, score] = await pyodide.runPythonAsync(`check_ssl("${input}")`); break;
                    case 'malware': [result, score] = await pyodide.runPythonAsync(`scan_malware("${input}")`); break;
                    case 'brute': [result, score] = await pyodide.runPythonAsync(`detect_brute_force(${input})`); break;
                    case 'spam': [result, score] = await pyodide.runPythonAsync(`filter_spam("${input}")`); break;
                    case 'vuln': [result, score] = await pyodide.runPythonAsync(`scan_vuln("${input}")`); break;
                    case 'ddos': [result, score] = await pyodide.runPythonAsync(`alert_ddos(${input})`); break;
                    case 'behavior': [result, score] = await pyodide.runPythonAsync(`monitor_behavior(${input})`); break;
                    case 'chat': [result, score] = await pyodide.runPythonAsync(`analyze_chat("${input.replace(/\n/g, '\\n')}")`); break;
                }
                document.getElementById(`${tool}Result`).innerHTML = `Status: ${result}, Score: ${score}`;
            } catch (e) {
                console.error(`Error in runTool(${tool}):`, e);
                document.getElementById(`${tool}Result`).innerHTML = "Error processing input!";
            } finally {
                inputElement.classList.remove('input-loading');
            }
        }

        async function runDroneTool(tool, inputId) {
            console.log(`Attempting to run drone tool: ${tool} with input ID: ${inputId}`);
            if (!pyodide) {
                alert("System initializing, please wait...");
                return;
            }
            const input = document.getElementById(inputId);
            input.classList.add('input-loading');
            if (!input.files.length) {
                document.getElementById(`${tool}Result`).innerHTML = "Upload a file to proceed!";
                input.classList.remove('input-loading');
                return;
            }

            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = async function(e) {
                const content = e.target.result;
                let result, score;
                try {
                    switch (tool) {
                        case 'droneTrace': [result, score] = await pyodide.runPythonAsync(`drone_trace_ai("${content}")`); break;
                        case 'skySniffer': [result, score] = await pyodide.runPythonAsync(`sky_sniffer("${content}")`); break;
                        case 'droneGhost': [result, score] = await pyodide.runPythonAsync(`drone_ghost("${content}")`); break;
                        case 'cloudSentry': [result, score] = await pyodide.runPythonAsync(`cloud_sentry("${content}")`); break;
                        case 'droneIDLock': [result, score] = await pyodide.runPythonAsync(`drone_id_lock("${content}")`); break;
                        case 'visionSentry': [result, score] = await pyodide.runPythonAsync(`vision_sentry_ai("${content}")`); break;
                        case 'flightPath': [result, score] = await pyodide.runPythonAsync(`flight_path_ai("${content}")`); break;
                        case 'payloadGuard': [result, score] = await pyodide.runPythonAsync(`payload_guard_ai("${content}")`); break;
                        case 'signalTrace': [result, score] = await pyodide.runPythonAsync(`signal_trace_ai("${content}")`); break;
                        case 'geoFence': [result, score] = await pyodide.runPythonAsync(`geo_fence_ai("${content}")`); break;
                    }
                    document.getElementById(`${tool}Result`).innerHTML = `Status: ${result}, Score: ${score}`;
                } catch (e) {
                    console.error(`Error in runDroneTool(${tool}):`, e);
                    document.getElementById(`${tool}Result`).innerHTML = "Error processing file!";
                } finally {
                    input.classList.remove('input-loading');
                }
            };
            reader.readAsText(file);
        }

        function showLearnMore(tool) {
            console.log(`Showing Learn More for: ${tool}`);
            const modal = document.getElementById('modal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');

            const guides = {
                droneTrace: {
                    title: 'DroneTraceAI Protocol',
                    content: 'DroneTraceAI leverages AI to analyze flight logs for anomalies. Upload CSV, JSON, or TXT files with drone data (e.g., GPS, timestamps). The system detects unauthorized flight patterns or restricted zone activity. Compatible with DJI, Parrot, and custom drones.'
                },
                skySniffer: {
                    title: 'SkySniffer Protocol',
                    content: 'SkySniffer captures drone wireless signals for forensic analysis. Upload PCAP or TXT files obtained via SDR hardware. The tool decodes Wi-Fi, Bluetooth, or RF communications to identify suspicious patterns. Ensure proper signal capture for optimal results.'
                },
                droneGhost: {
                    title: 'DroneGhost Protocol',
                    content: 'DroneGhost recovers deleted data from drone memory. Upload BIN or DUMP files extracted from RAM or storage. The system reconstructs media or logs using advanced carving techniques. Pair with tools like Volatility for memory dumps.'
                },
                cloudSentry: {
                    title: 'CloudSentry Protocol',
                    content: 'CloudSentry retrieves drone data from cloud services. Upload JSON or XML files containing API responses or logs (e.g., DJI cloud). The tool extracts flight paths, media, or metadata. Verify legal access to cloud endpoints before analysis.'
                },
                droneIDLock: {
                    title: 'DroneIDLock Protocol',
                    content: 'DroneIDLock authenticates drone identifiers like serial numbers or Remote IDs. Upload TXT or CSV files with ID data. The system verifies against global registries to detect tampering or confirm ownership. Ideal for stolen drone investigations.'
                },
                visionSentry: {
                    title: 'VisionSentryAI Protocol',
                    content: 'VisionSentryAI analyzes drone camera footage for suspicious objects or activities. Upload MP4, MOV, or AVI files. The system uses computer vision to detect unauthorized items or patterns. Ensure high-resolution footage for accurate results.'
                },
                flightPath: {
                    title: 'FlightPathAI Protocol',
                    content: 'FlightPathAI examines telemetry data for tampering or unauthorized routes. Upload CSV or JSON files with flight logs. The system cross-references GPS and sensor data to detect anomalies. Compatible with most commercial drones.'
                },
                payloadGuard: {
                    title: 'PayloadGuardAI Protocol',
                    content: 'PayloadGuardAI verifies drone payload integrity, checking weight and content. Upload CSV or TXT files with sensor data. The system flags discrepancies in payload metrics. Ideal for delivery or surveillance drones.'
                },
                signalTrace: {
                    title: 'SignalTraceAI Protocol',
                    content: 'SignalTraceAI tracks drone signal origins across Wi-Fi, RF, or LTE. Upload PCAP or TXT files from signal captures. The system cross-references sources to pinpoint unauthorized controllers. Use with high-sensitivity receivers.'
                },
                geoFence: {
                    title: 'GeoFenceAI Protocol',
                    content: 'GeoFenceAI detects breaches in restricted zones using flight data. Upload CSV or JSON files with GPS logs. The system flags unauthorized entries in real-time. Configure with up-to-date no-fly zone databases.'
                }
            };

            modalTitle.textContent = guides[tool].title;
            modalContent.textContent = guides[tool].content;
            modal.classList.remove('hidden');
        }

        function closeModal() {
            console.log('Closing modal');
            document.getElementById('modal').classList.add('hidden');
        }

        async function checkScore() {
            console.log('checkScore triggered');
            const urlInput = document.getElementById('urlInput');
            urlInput.classList.add('input-loading');
            const url = urlInput.value;
            if (!url) {
                document.getElementById('result').innerHTML = "Input required for analysis!";
                urlInput.classList.remove('input-loading');
                return;
            }

            let score = 0;
            let report = "";
            const apiKey = "YOUR_GOOGLE_SAFE_BROWSING_API_KEY"; // Replace with your free API key

            if (url.startsWith("https://")) {
                score += 40;
                report += "✅ HTTPS protocol active (40 points)<br>";
            } else {
                report += "❌ HTTPS protocol missing (0 points)<br>";
            }

            try {
                const response = await fetch(
                    `https://safebrowsing.googleapis.com/v4/threatMatches:find?key=${apiKey}`,
                    {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            client: { clientId: "AirMShield", clientVersion: "1.0" },
                            threatInfo: {
                                threatTypes: ["MALWARE", "SOCIAL_ENGINEERING", "UNWANTED_SOFTWARE"],
                                platformTypes: ["ANY_PLATFORM"],
                                threatEntryTypes: ["URL"],
                                threatEntries: [{ url }]
                            }
                        })
                    }
                );
                const data = await response.json();
                if (!data.threatMatches) {
                    score += 30;
                    report += "✅ No threats detected (30 points)<br>";
                } else {
                    report += "⚠️ Threats identified (0 points)<br>";
                }
            } catch (e) {
                console.error('Error in checkScore:', e);
                report += "⚠️ Threat scan unavailable, fallback engaged...<br>";
                const suspiciousKeywords = ["login", "bank", "secure", "update", "password", "verify", "account"];
                let keywordFound = false;
                for (let keyword of suspiciousKeywords) {
                    if (url.toLowerCase().includes(keyword)) {
                        keywordFound = true;
                        break;
                    }
                }
                if (!keywordFound) {
                    score += 20;
                    report += "✅ No suspicious keywords (20 points)<br>";
                } else {
                    report += "⚠️ Suspicious keywords detected (0 points)<br>";
                }
            }

            if (url.length < 30) {
                score += 20;
                report += "✅ Compact URL structure (20 points)<br>";
            } else {
                report += "⚠️ Extended URL structure (0 points)<br>";
            }

            const domainParts = (url.split('/')[2] || url).split('.');
            if (domainParts.length <= 3) {
                score += 10;
                report += "✅ Minimal subdomains (10 points)<br>";
            } else {
                report += "⚠️ Multiple subdomains detected (0 points)<br>";
            }

            document.getElementById('result').innerHTML = `System Analysis: <b>${score}/100</b><br>${report}`;
            urlInput.classList.remove('input-loading');
        }

        // Add touch and click support for all inputs and buttons
        document.querySelectorAll('input, button, label.file-label').forEach(element => {
            element.addEventListener('click', function(e) {
                console.log(`Click on ${element.id || element.tagName}`);
                e.preventDefault();
                e.stopPropagation();
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.focus();
                    element.select();
                }
            });
            element.addEventListener('touchstart', function(e) {
                console.log(`Touchstart on ${element.id || element.tagName}`);
                e.preventDefault();
                e.stopPropagation();
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.focus();
                    element.select();
                } else if (element.classList.contains('file-label')) {
                    document.getElementById(element.getAttribute('for')).click();
                }
            });
            element.addEventListener('touchend', function(e) {
                console.log(`Touchend on ${element.id || element.tagName}`);
                e.preventDefault();
                e.stopPropagation();
            });
        });
    </script>
</body>
</html>
